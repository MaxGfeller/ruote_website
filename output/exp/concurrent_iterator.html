<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <title>ruote - concurrent_iterator expression</title>
    <script src='/js/shCore.js'></script>
    <script src='/js/shBrushRuby.js'></script>
    <script src='/js/shBrushJScript.js'></script>
    <script src='/js/shBrushXml.js'></script>
    <link href='/css/reset.css' rel='stylesheet' type='text/css' />
    <link href='/css/shCore.css' rel='stylesheet' type='text/css' />
    <link href='/css/shThemeDefault.css' rel='stylesheet' type='text/css' />
    <link href='/css/ruote.css' rel='stylesheet' type='text/css' />
  </head><body>
    <div id='container'>
      <div id='header'>
        <div id='header-top'>
          <div id='header-left'>
            <a href='/'>
              <img align='left' src='/images/ruote.png' />
              <span id='ruote' onclick="location.href = '/'; return true;">
                ruote 2.1
              </span>
            </a>
          </div>
          <div id='header-right'>
          </div>
        </div>
        <div id='header-bottom'>
          <div id='header-subtitle'>
            open source ruby workflow engine
          </div>
          <div id='header-menu'>
            <a href='documentation.html' title='documentation'>doc</a>
            <a href='source.html' title='source code'>source</a>
            <a href='download.html' title='download'>download</a>
            <a href='lists.html' title='mailing lists and irc'>lists</a>
            <a href='http://jmettraux.wordpress.com' title='blog'>blog</a>
            <a href='map.html' title='map'>map</a>
            <a class='nihongo' href='ja.html' title='日本語'>日本語</a>
          </div>
        </div>
      </div>
      <div id='content'>
        <h2>concurrent_iterator</h2>
        <p>This expression is a cross between &#8216;concurrence&#8217; and &#8216;iterator&#8217;.</p>
        <p>Please look at the documentation of &#8216;iterator&#8217; to learn more about the<br />
        common options between &#8216;iterator&#8217; and &#8216;concurrent-iterator&#8217;.</p>
        <pre class="brush: ruby">
          pdef = Ruote.process_definition :name =&gt; 'test' do
            concurrent_iterator :on_val =&gt; 'alice, bob, charly', :to_var =&gt; 'v' do
              participant '${v:v}'
            end
          end
        </pre>
        <p>will be equivalent to</p>
        <pre class="brush: ruby">
          pdef = Ruote.process_definition :name =&gt; 'test' do
            concurrence do
              participant 'alice'
              participant 'bob'
              participant 'charly'
            end
          end
        </pre>
        <p>The &#8216;on&#8217; and the &#8216;to&#8217; attributes follow exactly the ones for the iterator<br />
        expression.</p>
        <p>When there is no &#8216;to&#8217;, the current iterated value is placed in the variable<br />
        named &#8216;i&#8217;.</p>
        <p>The variable named &#8216;ii&#8217; contains the current iterated index (an int bigger<br />
        or egal to 0).</p>
        <p>&#8216;concurrent_iterator&#8217; does not understand commands like<br />
        rewind/break/jump/&#8230; like &#8216;iterator&#8217; does, since it fires all its<br />
        branches when applied.</p>
        <h3>:times and :branches</h3>
        <p>Similarly to the iterator expression, the :times or the :branches attribute<br />
        may be used in stead of the &#8216;on&#8217; attribute.</p>
        <pre class="brush: ruby">
          pdef = Ruote.process_definition :name =&gt; 'test' do
            concurrent_iterator :times =&gt; 3 do
              participant 'user${v:i}'
            end
          end
        </pre>
        <p>is equivalent to</p>
        <pre class="brush: ruby">
          pdef = Ruote.process_definition :name =&gt; 'test' do
            concurrence do
              participant 'user0'
              participant 'user1'
              participant 'user2'
            end
          end
        
        </pre>
        <h3>options</h3>
        <p>the concurrent_iterator accepts the same options for merging as its bigger<br />
        brother, the concurrence expression.</p>
        <p>:count, :merge (override, mix, isolate), remaining (cancel, forget) and<br />
        :over.</p>
        <h3>add branches</h3>
        <p>The &#8216;add_branches&#8217;/&#8216;add_branch&#8217; expression can be used to add branches<br />
        to a concurrent-iterator while it is running.</p>
        <pre class="brush: ruby">
          concurrent_iterator :on =&gt; 'a, b, c' do
            sequence do
              participant :ref =&gt; 'worker_${v:i}'
              add_branches 'd, e', :if =&gt; '${v:/not_sufficient}'
            end
          end
        </pre>
        <p>In this example, if the process level variable &#8216;not_sufficient&#8217; is set to<br />
        true, workers d and e will be added to the iterated elements.</p>
        <p>Read more at the &#8216;add_branches&#8217; expression description.</p>
      </div>
      <div id='footer'>
        <div id='footer-left'>
          this website was created with
          <a href='http://nanoc.stoneship.org'>nanoc</a>
          and
          <a href='http://alexgorbatchev.com/SyntaxHighlighter/'>syntax highlighter</a>
        </div>
        <div id='footer-right'>
          &copy; 2005-2010 the ruote team
        </div>
      </div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        SyntaxHighlighter.all();
      //]]>
    </script>
    <script src='http://www.google-analytics.com/ga.js' type='text/javascript'></script>
    <script type='text/javascript'>
      //<![CDATA[
        if (location.hostname != 'localhost' && location.hostname != '127.0.0.1') {
          var pageTracker=_gat._getTracker('UA-138748-2');
          pageTracker._initData();
          pageTracker._trackPageview();
        }
      //]]>
    </script>
  </body>
</html>
