<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <title>ruote - engine_participant</title>
    <script src='/js/shCore.js'></script>
    <script src='/js/shBrushRuby.js'></script>
    <script src='/js/shBrushJScript.js'></script>
    <script src='/js/shBrushXml.js'></script>
    <link href='/css/reset.css' rel='stylesheet' type='text/css' />
    <link href='/css/shCore.css' rel='stylesheet' type='text/css' />
    <link href='/css/shThemeDefault.css' rel='stylesheet' type='text/css' />
    <link href='/css/ruote.css' rel='stylesheet' type='text/css' />
  </head><body>
    <div id='container'>
      <div id='header'>
        <div id='header-top'>
          <div id='header-left'>
            <a href='/'>
              <img src='/images/ruote.png' />
            </a>
            <div id='header-subtitle'>
              open source ruby workflow engine
            </div>
          </div>
          <div id='header-right'>
          </div>
        </div>
        <div id='nav'>
          <span>
            <a href='documentation.html' title='documentation'>doc</a>
            <a href='source.html' title='source code'>source</a>
            <a href='download.html' title='download'>download</a>
            <a href='lists.html' title='mailing lists and irc'>lists</a>
            <a href='http://jmettraux.wordpress.com' title='blog'>blog</a>
            <a href='map.html' title='map'>map</a>
            <a class='nihongo' href='ja.html' title='日本語'>日本語</a>
          </span>
        </div>
      </div>
      <div id='content'>
        <h2>engine_participant</h2>
        <p>A participant for pushing the execution of [segments of] processes to<br />
        other engines.</p>
        <p>It works by giving the participant the connection information to the storage<br />
        of the other engine.</p>
        <p>For instance :</p>
        <pre class="brush: ruby">
          engine0 =
            Ruote::Engine.new(
              Ruote::Worker.new(
                Ruote::FsStorage.new('work0', 'engine_id' =&gt; 'engine0')))
          engine1 =
            Ruote::Engine.new(
              Ruote::Worker.new(
                Ruote::FsStorage.new('work1', 'engine_id' =&gt; 'engine1')))
        
          engine0.register_participant('engine1',
            Ruote::EngineParticipant,
            'storage_class' =&gt; Ruote::FsStorage,
            'storage_path' =&gt; 'ruote/storage/fs_storage',
            'storage_args' =&gt; 'work1')
          engine1.register_participant('engine0',
            Ruote::EngineParticipant,
            'storage_class' =&gt; Ruote::FsStorage,
            'storage_path' =&gt; 'ruote/storage/fs_storage',
            'storage_args' =&gt; 'work0')
        </pre>
        <p>In this example, two engines are created (note that their &#8216;engine_id&#8217; is<br />
        explicitely set (else it would default to &#8216;engine&#8217;)). Each engine is then<br />
        registered as participant in the other engine. The registration parameters<br />
        detail the class and the arguments to the storage of the target engine.</p>
        <p>This example is a bit dry / flat. A real world example would perhaps detail<br />
        a &#8216;master&#8217; engine connected to &#8216;departmental&#8217; engines, something more<br />
        hierarchical.</p>
        <p>The example also binds reciprocally engines. If the delegated processes<br />
        are always &#8216;forgotten&#8217;, one could imagine not binding the source engine<br />
        as a participant in the target engine (not need to answer back).</p>
        <p>There are then two variants for calling a subprocess</p>
        <pre class="brush: ruby">
          subprocess :ref =&gt; 'subprocess_name', :engine =&gt; 'engine1'
            # or
          participant :ref =&gt; 'engine1', :pdef =&gt; 'subprocess_name'
        </pre>
        <p>It&#8217;s OK to go for the shorter versions :</p>
        <pre class="brush: ruby">
          subprocess_name :engine =&gt; 'engine1'
            # or
          participant 'engine1', :pdef =&gt; 'subprocess_name'
          engine1 :pdef =&gt; 'subprocess_name'
        </pre>
        <p>The subprocess is defined in the current process, or it&#8217;s given via its<br />
        <span class="caps">URL</span>. The third variant is a subprocess bound as an engine variable.</p>
        <pre class="brush: ruby">
          engine.variables['variant_3'] = Ruote.process_definition do
            participant 'hello_world_3'
          end
        
          pdef = Ruote.process_definition do
            sequence do
              engine1 :pdef =&gt; 'variant_1'
              engine1 :pdef =&gt; 'http://pdefs.example.com/variant_2.rb'
              engine1 :pdef =&gt; 'variant_3'
            end
            define 'variant_1' do
              participant 'hello_world_1'
            end
          end
        </pre>
      </div>
    </div>
    <div id='footer'>
      <p>
        <span id='footer-left'>
          this website was created with
          <a href='http://nanoc.stoneship.org'>nanoc</a>
          and
          <a href='http://alexgorbatchev.com/SyntaxHighlighter/'>syntax highlighter</a>
        </span>
        <span id='footer-right'>
          &copy; 2005-2010 the ruote team
        </span>
      </p>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        SyntaxHighlighter.all();
      //]]>
    </script>
    <script src='http://www.google-analytics.com/ga.js' type='text/javascript'></script>
    <script type='text/javascript'>
      //<![CDATA[
        if (location.hostname != 'localhost' && location.hostname != '127.0.0.1') {
          var pageTracker=_gat._getTracker('UA-138748-2');
          pageTracker._initData();
          pageTracker._trackPageview();
        }
      //]]>
    </script>
  </body>
</html>
